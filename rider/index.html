<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Генератор Технического Райдерa</title>
<script src="https://unpkg.com/pizzip@3.1.5/dist/pizzip.min.js"></script>
<script src="https://unpkg.com/docxtemplater@3.29.3/build/docxtemplater.js"></script>
<style>
body {
font-family: Arial, sans-serif;
margin: 20px;
}
label, textarea, input {
display: block;
margin-bottom: 10px;
width: 100%;
}
button {
padding: 10px 15px;
background-color: #007bff;
color: #fff;
border: none;
cursor: pointer;
}
</style>
</head>
<body>
<h1>Генератор Технического Райдерa</h1>
<form id="form">
<label for="name">Название мероприятия:</label>
<input type="text" id="name" required>

<label for="customer">Заказчик:</label>
<input type="text" id="customer" required>

<label for="phone">Телефон:</label>
<input type="tel" id="phone" required>

<label for="date">Дата:</label>
<input type="date" id="date" required>

<label for="time">Время:</label>
<input type="time" id="time" required>

<label for="hall">Зал:</label>
<select id="hall" required>
<option value="Большой зал">Большой зал</option>
<option value="Мраморный зал">Мраморный зал</option>
<option value="Гостиная">Гостиная</option>
</select>

<label for="sound">Звуковое техническое обеспечение:</label>
<textarea id="sound" required></textarea>

<label for="light">Световое техническое обеспечение:</label>
<textarea id="light" required></textarea>

<label for="video">Видео оформление мероприятия:</label>
<textarea id="video" required></textarea>

<label for="scene">Постановочная часть:</label>
<textarea id="scene" required></textarea>

<button type="submit">Скачать .docx</button>
</form>

<script>
document.getElementById('form').addEventListener('submit', function(event) {
event.preventDefault();

// Получаем данные из формы
const name = document.getElementById('name').value;
const customer = document.getElementById('customer').value;
const phone = document.getElementById('phone').value;
const date = document.getElementById('date').value;
const time = document.getElementById('time').value;
const hall = document.getElementById('hall').value;
const sound = document.getElementById('sound').value;
const light = document.getElementById('light').value;
const video = document.getElementById('video').value;
const scene = document.getElementById('scene').value;

// Загружаем шаблон
fetch('template.docx') // Убедитесь, что шаблон доступен по этому пути
.then(response => response.arrayBuffer())
.then(data => {
// Загружаем шаблон в PizZip
const zip = new PizZip(data);
const doc = new Docxtemplater(zip, { paragraphLoop: true, linebreaks: true });

// Подставляем данные в шаблон
doc.setData({
name: name,
customer: customer,
phone: phone,
date: date,
time: time,
hall: hall,
sound: sound,
light: light,
video: video,
scene: scene
});

try {
doc.render(); // Рендерим документ с подставленными данными
} catch (error) {
console.error(error);
}

// Генерация файла .docx
const output = doc.getZip().generate({ type: 'blob' });

// Создаем ссылку для скачивания
const link = document.createElement('a');
link.href = URL.createObjectURL(output);
link.download = `${date}-${name}.docx`;
link.click(); // Запускаем скачивание
})
.catch(err => {
console.error('Ошибка при загрузке шаблона:', err);
});
});
</script>
</body>
</html>
